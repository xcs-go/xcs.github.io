---
layout: page
title: "async"
tags: [es6]
date: 2017-10-08
excerpt: "async学习"
comments: true
category: ES6
---
### async函数
async函数就是Generator函数的语法糖。

以下是使用Generator函数和async函数来读取文件的方式
{% highlight javascript %}
    const fs = require('fs');
    const readFile = function(filename){
        return new Promise(function(resolve,reject){
            fs.readFile(filename,function(err,data){
                if (err) return reject(err);
                resolve(data);
            })
        })
    }
    const gen = function* (){
        let x = yield readFile('Afile');
        let y = yield readFile('Bfile');
        console.log(x.toString());
        console.log(y.toString());
    }
    const g = gen();
    g.next();
    // 使用async函数的写法
    const asyncReadFile = async function(){
        let x = await readFile('Afile');
        let y = await readFile('Bfile');
        console.log(x.toString());
        console.log(y.toString());
    }
    asyncReadFile();
{% endhighlight %}

### async函数的优化体现在以下方面
- 内置执行器
    
    async函数内部自带执行器，不需要再编写函数执行器，而Generator函数自动执行需要执行器或者是co模块.
    因此，调用async函数只需要在函数名后面加上()即可。
- 语义化更加的清晰
    
    await和async比*和yield语义更加的清晰。
- 使用更加灵活
    
    co模块规定，yield后面的表达式必须是Thunk函数或者是Promise对象。而async函数的await后面表达式不限定类型，
    可以是Thunk函数，Promise对象，也可以是基本数据类型。
- 返回值是Promise对象
    
    async函数的返回值是Promise对象，可以直接使用then方法进行操作，而Generator函数执行的返回值是Iterator对象，
    需要使用next()方法进行操作。
    
### async语法


